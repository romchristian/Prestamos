<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:gp="http://java.sun.com/jsf/composite/gpymes"
                xmlns:f="http://java.sun.com/jsf/core">


    <ui:decorate template="/plantillaDashboard.xhtml">






        <ui:define name="body">
            <h:form>



                <h:outputScript library="js" name="highcharts.js"/>
                <h:outputScript library="js" name="exporting.js"/>

                <script type="text/javascript">

                    var formatNumber = {
                        separador: ".", // separador para los miles
                        sepDecimal: ',', // separador para los decimales
                        formatear: function (num) {
                            num += '';
                            var splitStr = num.split('.');
                            var splitLeft = splitStr[0];
                            var splitRight = splitStr.length > 1 ? this.sepDecimal + splitStr[1] : '';
                            var regx = /(\d+)(\d{3})/;
                            while (regx.test(splitLeft)) {
                                splitLeft = splitLeft.replace(regx, '$1' + this.separador + '$2');
                            }
                            return this.simbol + splitLeft + splitRight;
                        },
                        new : function (num, simbol) {
                            this.simbol = simbol || '';
                            return this.formatear(num);
                        }
                    }

                    var $ = jQuery;


                    Highcharts.numberFormat(this.value, 0, '.', ',');

                    $(function () {
                        $('#container').highcharts({
                            chart: {
                                type: 'column'
                            },
                            title: {
                                text: ''
                            },
                            xAxis: {
                                categories: [
                                    'Del Dia'
                                ],
                                crosshair: true,
                            },
                            yAxis: {
                                min: 0,
                                title: {
                                    text: 'Monto (guaranies)'
                                }

                            },
                            tooltip: {
                                headerFormat: '<span style="font-size:10px">{point.key}</span><table width="250px">',
                                pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                                        '<td style="padding:0"><b>{point.y} Gs</b></td></tr>',
                                footerFormat: '</table>',
                                shared: true,
                                useHTML: true,
                            },
                            plotOptions: {
                                column: {
                                    pointPadding: 0.2,
                                    borderWidth: 0
                                }
                            },
                            series: [{
                                    name: 'Saldo',
                                    data: [#{controlTesoreriaBean.vistaGrafico.saldo}],
                                    dataLabels: {
                                        enabled: true,
                                        style: {
                                            fontSize: '10pt'
                                        }
                                    }

                                }, {
                                    name: 'Entradas',
                                    data: [#{controlTesoreriaBean.vistaGrafico.entradas}],
                                    dataLabels: {
                                        enabled: true,
                                        format: '{y:,.0f}',
                                        style: {
                                            fontSize: '10pt'
                                        }
                                    }

                                }, {
                                    name: 'Salidas',
                                    data: [#{controlTesoreriaBean.vistaGrafico.salidas}],
                                    dataLabels: {
                                        enabled: true,
                                        format: formatNumber.new('{y:.0f}'),
                                        style: {
                                            fontSize: '10pt'
                                        }
                                    }

                                }, {
                                    name: 'Disponible',
                                    data: [#{controlTesoreriaBean.vistaGrafico.disponible}],
                                    dataLabels: {
                                        enabled: true,
                                        format: '{y:,.0f}',
                                        style: {
                                            fontSize: '10pt'
                                        }
                                    }

                                }]
                        });
                    });
                </script>



                <h:form>

                    <div class="caja">

                        <div class="ui-grid ui-grid-responsive">

                            <div class="ui-grid-row">
                                <div class="ui-grid-col-6">

                                    <div style="display: table;width: 100%">
                                        <div style="display: table-cell;vertical-align: middle;width: 50%">
                                            <h3>Cheques Recibidos</h3>
                                        </div>
                                        <div style="display: table-cell;text-align: right;vertical-align: middle;width: 50%">
                                            <p:commandButton styleClass="btnCheques" value="Mes" action="#{controlTesoreriaBean.buscaChequesMes()}" update="cheques"/>
                                            <p:commandButton styleClass="btnCheques" value="Semana" action="#{controlTesoreriaBean.buscaChequesSemana()}" update="cheques"/>
                                            <p:commandButton styleClass="btnCheques" value="Hoy" action="#{controlTesoreriaBean.buscaChequesHoy()}" update="cheques"/>
                                        </div>
                                    </div>

                                    <br/>
                                    <hr/>
                                    <br/>
                                    <br/>
                                    <p:blockUI block="cheques" trigger="@(.btnCheques)">
                                        <p:graphicImage library="img" name="loading_bar.gif" width="128" style="background: transparent"/>

                                    </p:blockUI>
                                    <p:dataTable value="#{controlTesoreriaBean.cheques}" var="c" id="cheques">
                                        <p:column headerText="Banco" style="font-size: 9pt">
                                            <h:outputText value="#{c.banco.nombre}"/>
                                        </p:column>
                                        <p:column headerText="Vencimiento" style="font-size: 9pt">
                                            <h:outputText value="#{c.vencimiento}">
                                                <f:convertDateTime locale="#{formato.locale}" pattern="#{formato.patronFecha}"/>
                                            </h:outputText>
                                        </p:column>
                                        <p:column headerText="Desc" style="font-size: 9pt">
                                            <h:outputText value="#{c.descripcion}"/>
                                        </p:column>
                                        <p:column headerText="Monto" style="font-size: 9pt">
                                            <h:outputText value="#{c.monto}">
                                                <f:convertNumber locale="#{formato.locale}"/>
                                            </h:outputText>
                                        </p:column>
                                    </p:dataTable>
                                </div>
                                <div class="ui-grid-col-6">
                                    <div id="container" style="min-width: 310px; height: 400px; margin: 0 auto"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                </h:form>


            </h:form>




        </ui:define>
    </ui:decorate>
</ui:composition>
